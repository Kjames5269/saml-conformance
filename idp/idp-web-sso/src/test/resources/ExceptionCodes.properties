# PROFILES

SAMLProfiles.4.1.4.2_a=If the <Response> message is signed or if an enclosed assertion is encrypted, then the \
  <Issuer> element MUST be present.

SAMLProfiles.4.1.4.2_b=If present [the Issuer] MUST contain the unique identifier of the issuing identity provider.

SAMLProfiles.4.1.4.2_c=The Format attribute MUST be omitted or have a value of urn:oasis:names:tc:SAML:2.0:nameid-format:entity.

SAMLProfiles.4.1.4.2_d=[A Response] MUST contain at least one <Assertion>.

SAMLProfiles.4.1.4.2_e=Each assertion's <Issuer> element MUST contain the unique identifier of the [E26]responding identity provider

# todo SAMLProfiles.4.1.4.2f= If multiple assertions are included, then each assertion's <Subject> element MUST refer to the same principal.

SAMLProfiles.4.1.4.2_g=Any assertion issued for consumption using this profile MUST contain a <Subject> element.

SAMLProfiles.4.1.4.2_h=Any assertion issued for consumption using this profile MUST contain a <Subject> element with \
  at least one <SubjectConfirmation> element containing a Method of urn:oasis:names:tc:SAML:2.0:cm:bearer.

SAMLProfiles.4.1.4.2_i=At lease one bearer <SubjectConfirmation> element MUST contain a <SubjectConfirmationData> \
  element that itself MUST contain a Recipient attribute containing the service provider's assertion \
  consumer service URL and a NotOnOrAfter attribute that limits the window during which the assertion \
  can be [E52]confirmed by the relying party. It MAY also contain an Address attribute limiting the \
  client address from which the assertion can be delivered. It MUST NOT contain a NotBefore attribute. \
  If the containing message is in response to an <AuthnRequest>, then the InResponseTo attribute MUST \
  match the request's ID.

SAMLProfiles.4.1.4.2_j=The set of one or more bearer assertions MUST contain at least one <AuthnStatement> that \
reflects the authentication of the principal to the identity provider.

SAMLProfiles.4.1.4.2_k=If the identity provider supports the Single Logout profile, defined in Section 4.4, any \
  authentication statements MUST include a SessionIndex attribute to enable per-session logout \
  requests by the service provider.

SAMLProfiles.4.1.4.2_l=Each bearer assertion MUST contain an <AudienceRestriction> including \
  the service provider's unique identifier as an <Audience>.

SAMLProfiles.4.1.4.5=If the HTTP POST binding is used to deliver the <Response>, [E26]each assertion MUST be \
  protected by a digital signature. This can be accomplished by signing each individual element or by <Assertion> \
  signing the <Response> element.

# CORE

SAMLCore.2.2.4_a=The Type attribute [for an EncryptedData] SHOULD be present and, if present, MUST contain a value of \
  http://www.w3.org/2001/04/xmlenc#Element.

# todo SAMLCore.2.2.4_b=The encrypted content MUST contain an element that has a type of NameIDType or AssertionType, or a type that is derived from BaseIDAbstractType, NameIDType, or AssertionType.

# todo SAMLCore.2.2.4_c=Encrypted identifiers are intended as a privacy protection mechanism when the plain-text value passes through an intermediary. As such, the ciphertext MUST be unique to any given encryption operation. For more on such issues, see [XMLEnc] Section 6.3.

SAMLCore.2.2.3_a=An xsi:type attribute MUST be used to indicate the actual statement type.

SAMLCore.2.2.3_b=An assertion with no statements MUST contain a <Subject> element. Such an assertion identifies a \
  principal in a manner which can be referenced or confirmed using SAML methods, but asserts no further information \
  associated with that principal.

SAMLCore.2.3.4_a=The Type attribute [for an EncryptedData] SHOULD be present and, if present, MUST contain a value of \
  http://www.w3.org/2001/04/xmlenc#Element.

# todo SAMLCore.2.3.4_b=The encrypted content MUST contain an element that has a type of or derived from AssertionType.

# todo SAMLCore.2.4.1.2=SAML extensions MUST NOT add local (non-namespace-qualified) XML attributes or XML attributes qualified by a SAML-defined namespace to the SubjectConfirmationDataType complex type or a derivation of it; such attributes are reserved for future maintenance and enhancement of SAML itself.

SAMLCore.2.5.1_a=An xsi:type attribute MUST be used [in the Condition element] to indicate the actual condition type.

SAMLCore.2.5.1_b=There MUST be at most one instance of [the OneTimeUse] element [under Conditions].

SAMLCore.2.5.1_c=There MUST be at most one instance of [the ProxyRestriction] element [under Conditions].

SAMLCore.2.5.1.2=If both attributes are present, the value for NotBefore MUST be less than (earlier than) the value for NotOnOrAfter.

SAMLCore.2.5.1.5=A SAML authority MUST NOT include more than one <OneTimeUse> element within a <Conditions> element of an assertion.

SAMLCore.2.5.1.6=A SAML authority MUST NOT include more than one <ProxyRestriction> element within a <Conditions> element of an assertion.

SAMLCore.2.7.2=Assertions containing <AuthnStatement> elements MUST contain a <Subject> element.

SAMLCore.2.7.3=Assertions containing <AttributeStatement> elements MUST contain a <Subject> element.

SAMLCore.2.7.3.1=Within an <AttributeStatement>, if the SAML attribute exists but has no values, then the <AttributeValue> element MUST be omitted.